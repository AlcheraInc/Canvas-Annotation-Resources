
<!DOCTYPE html>
<html>
<head>
    <script src="https://unpkg.com/konva@9.2.0/konva.min.js"></script>
    <meta charset="utf-8" />
    <title>Konva Modify Curves with Anchor Points Demo</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>
<div id="container"></div>
<script>
  var width = window.innerWidth;
  var height = window.innerHeight;

  // function to build anchor point
  function buildAnchor(x, y) {
    var anchor = new Konva.Circle({
      x: x,
      y: y,
      radius: 20,
      stroke: '#666',
      fill: '#ddd',
      strokeWidth: 2,
      draggable: true,
    });
    layer.add(anchor);

    // add hover styling
    anchor.on('mouseover', function () {
      document.body.style.cursor = 'pointer';
      this.strokeWidth(4);
    });
    anchor.on('mouseout', function () {
      document.body.style.cursor = 'default';
      this.strokeWidth(2);
    });

    anchor.on('dragmove', function () {
      updateDottedLines();
    });

    return anchor;
  }

  var stage = new Konva.Stage({
    container: 'container',
    width: width,
    height: height,
  });

  var layer = new Konva.Layer();
  stage.add(layer);

  // function to update line points from anchors
  function updateDottedLines() {
    var q = quad;

    var quadLinePath = layer.findOne('#quadLinePath');

    quadLinePath.points([
      q.start.x(),
      q.start.y(),
      q.control1.x(),
      q.control1.y(),
      q.control2.x(),
      q.control2.y(),
      q.end.x(),
      q.end.y(),
      q.start.x(),
      q.start.y(),
    ]);

  }
;


  var quadLinePath = new Konva.Line({
    dash: [1],
    strokeWidth: 3,
    stroke: 'black',
    lineCap: 'round',
    id: 'quadLinePath',
    points: [0, 0],
  });
  layer.add(quadLinePath);


  // special objects to save references to anchors
  var quad = {
    start: buildAnchor(60, 30),
    control1: buildAnchor(240, 110),
    control2: buildAnchor(140, 60),
    end: buildAnchor(80, 160),
    test: {x: 60, y:30}
  };


  updateDottedLines();
</script>
</body>
</html>
